---
layout: post
title: CVE-2021–42786, CVE-2021–42787, CVE-2021–42853, CVE-2021–42854, CVE-2021–42855, CVE-2021–42856, CVE-2021–42857
date: 2022-02-23 18:30:00 +0800
---

### Multiple vulnerabilities - SteelCentral AppInternals Dynamic Sampling Agent 11.8.5.527

#### CVE ID

CVE-2021–42786

CVE-2021–42787

CVE-2021–42853

CVE-2021–42854

CVE-2021–42855

CVE-2021–42856

CVE-2021–42857

#### Description

Multiple vulnerabilities in SteelCentral AppInternals Dynamic Sampling Agent 11.8.5.527

#### Tested Versions

SteelCentral AppInternals Dynamic Sampling Agent 11.8.5.527

#### Details

There exists multiple vulnerabilities in SteelCentral AppInternals Dynamic Sampling Agent 11.8.5.527, including: Remote Code Execution, Directory Traversal Read/Write/Delete, Local Privilege Escalation, Reflected Cross-site Scripting.

CVE-2021–42786: It was discovered that the SteelCentral AppInternals Dynamic Sampling Agent (DSA) has Remote Code Execution vulnerabilities in multiple instances of the API requests. The affected endpoints do not have any input validation of the user's input that allowed a malicious payload to be injected.

CVE-2021–42787: It was discovered that the SteelCentral AppInternals Dynamic Sampling Agent's (DSA) AgentConfigurationServlet has directory traversal vulnerabilities at the "/api/appInternals/1.0/agent/configuration" API. The affected endpoint does not have any input validation of the user's input that allows a malicious payload to be injected.

CVE-2021–42853: It was discovered that the SteelCentral AppInternals Dynamic Sampling Agent's (DSA) AgentDiagnosticServlet has directory traversal vulnerability at the "/api/appInternals/1.0/agent/diagnostic/logs" API. The affected endpoint does not have any input validation of the user's input that allows a malicious payload to be injected.

CVE-2021–42854: It was discovered that the SteelCentral AppInternals Dynamic Sampling Agent's (DSA) PluginServlet has directory traversal vulnerabilities at the "/api/appInternals/1.0/plugin/pmx" API. The affected endpoint does not have any input validation of the user's input that allows a malicious payload to be injected.

CVE-2021–42855: It was discovered that the SteelCentral AppInternals Dynamic Sampling Agent (DSA) uses the ".debug_command.config" file to store a json string that contains a list of IDs and pre-configured commands. The config file is subsequently used by the "/api/appInternals/1.0/agent/configuration" API to map the corresponding ID to a command to be executed.

CVE-2021–42856: It was discovered that the /DsaDataTest endpoint is susceptible to Cross-site scripting (XSS) attack. It was noted that the Metric parameter does not have any input checks on the user input that allows an attacker to craft its own malicious payload to trigger a XSS vulnerability.

CVE-2021–42857: It was discovered that the SteelCentral AppInternals Dynamic Sampling Agent's (DSA) AgentDaServlet has directory traversal vulnerabilities at the "/api/appInternals/1.0/agent/da/pcf" API. The affected endpoint does not have any validation of the user's input that allows a malicious payload to be injected.

#### Timeline

* 2021-11-09 - Vendor Disclosure
* 2022-02-10 - Vendor Patched
* 2022-02-23 - Public Release

#### Credit

Darrel Huang, Bjorn Lim, Leng Kang Hao from Government Technology Agency of Singapore
